import * as React from "react";
import * as ReactDOM from "react-dom";

import "../styles/popup.css";

function Hello() {
  const isGraphQL = window.location.search.includes("is-graphql=true");

  return (
    <div className={`popup ${isGraphQL ? "popup-success" : ""}`}>
        {isGraphQL ? (
          <>
            <div className="hero">
              <YesGraphQLIcon className="hero-icon" />
              <h2>Yes, it’s GraphQL</h2>
            </div>
            <div className="apis">
              <div className="api">github.com/api/graphql</div>
              <div className="api">xyz.com/rest-must-die/graphql/rest-must-die/graphql</div>
            </div>
          </>
        ) : (
          <>
            <div className="hero">
              <NoGraphQLIcon className="hero-icon" />
              <h2>No, it’s not  GraphQL (yet)</h2>
            </div>
          </>
        )}
      <div className="subline">
        <p className="made-by">
          Made by <GraphCDNLogo />
        </p>
        <a
          onClick={(evt) => {
            evt.preventDefault();
            chrome.tabs.query(
              { active: true, currentWindow: true },
              function (tabs) {
                chrome.tabs.create({
                  url: `mailto:extension@graphcdn.io?subject=${encodeURIComponent(
                    `False ${isGraphQL ? "positive" : "negative"} for ${
                      tabs[0]?.url || "ENTER URL HERE"
                    }`
                  )}&body=${encodeURIComponent(
                    `How do you know this website actually ${
                      isGraphQL ? "does not" : "does"
                    } use GraphQL?`
                  )}`,
                });
              }
            );
          }}
          // No-JS fallback
          href={`mailto:extension@graphcdn.io?subject=${encodeURIComponent(
            `False ${isGraphQL ? "positive" : "negative"} for ENTER URL HERE`
          )}&body=${encodeURIComponent(
            `How do you know this website actually ${
              isGraphQL ? "does not" : "does"
            } use GraphQL?`
          )}`}
          target="_blank"
          className="report-link"
        >
          Report incorrect result
        </a>
      </div>
    </div>
  );
}

function NoGraphQLIcon(props) {
  return (
    <svg
      {...props}
      width="80"
      height="80"
      fill="currentColor"
      viewBox="0 0 80 80"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        opacity="0.3"
        fillRule="evenodd"
        d="M3 40C3 19.566 19.566 3 40 3c9.678 0 18.487 3.715 25.08 9.798L12.799 65.08C6.715 58.487 3 49.678 3 40zm11.92 27.202C21.511 73.284 30.321 77 40 77c20.434 0 37-16.566 37-37 0-9.678-3.716-18.488-9.798-25.08L55.514 26.607l.243.14a4.701 4.701 0 011.06-.839 4.682 4.682 0 016.385 1.714 4.682 4.682 0 01-1.713 6.385 4.68 4.68 0 01-1.245.495v12.452a4.68 4.68 0 011.231.492 4.658 4.658 0 011.714 6.385c-1.285 2.236-4.15 2.999-6.385 1.714a4.64 4.64 0 01-1.156-.938l-10.712 6.185a4.676 4.676 0 01-4.436 6.144 4.667 4.667 0 01-4.672-4.672c0-.459.066-.903.19-1.322l-9.408-5.431-11.69 11.69zM40 0C17.909 0 0 17.909 0 40s17.909 40 40 40 40-17.909 40-40S62.091 0 40 0zm-2.865 59.023l-8.899-5.138 1.271-1.27h25.096c.025.102.054.204.086.306l-10.734 6.197a4.659 4.659 0 00-3.455-1.524 4.657 4.657 0 00-3.365 1.429zm10.76-24.797L31.73 50.392h22.869a4.686 4.686 0 011.315-2.28l-8.017-13.886zm9.946 12.781L49.522 32.6l4.365-4.365.773.446a4.665 4.665 0 003.362 5.813v12.466l-.18.048zm-7.707-23.505l-5.155-2.977c.125-.423.193-.871.193-1.335a4.667 4.667 0 00-4.672-4.672 4.667 4.667 0 00-4.672 4.672c0 .461.067.907.191 1.328l-10.781 6.225a4.71 4.71 0 00-1.055-.834c-2.236-1.285-5.1-.522-6.385 1.714-1.285 2.235-.522 5.1 1.713 6.385.4.23.818.393 1.245.496v12.45a4.685 4.685 0 00-1.232.493 4.682 4.682 0 00-.829 7.493l6.607-6.605a4.698 4.698 0 00-.214-.218l14.11-24.439a4.69 4.69 0 002.607 0l2.985 5.168 1.626-1.626-2.686-4.653c.043-.04.085-.082.126-.125l4.652 2.686 1.626-1.626zm-12.861-.932a4.765 4.765 0 01-.134-.133l-10.8 6.236a4.665 4.665 0 01-3.36 5.82V46.96c.06.015.122.031.183.049l14.11-24.44z"
        clipRule="evenodd"
      />
    </svg>
  );
}

function YesGraphQLIcon(props) {
  return (
    <svg
      {...props}
      width="80"
      height="80"
      fill="none"
      viewBox="0 0 80 80"
      xmlns="http://www.w3.org/2000/svg"
    >
      <g
        opacity="0.5"
        fill="none"
        stroke="currentColor"
        stroke-width="3"
        stroke-linecap="round"
      >
        <path d="M40.5-1.19v3.62"/>
        <path d="M56.45,1.98 l-1.39,3.35"/>
        <path d="M69.98,11.02 l-2.56,2.56"/>
        <path d="M79.02,24.55 l-3.35,1.39"/>
        <path d="M82.19,40.5h-3.62" />
        <path d="M79.02,56.45 l-3.35-1.39"/>
        <path d="M69.98,69.98 l-2.56-2.56"/>
        <path d="M56.45,79.02 l-1.39-3.35"/>
        <path d="M40.5,82.19v-3.62" />
        <path d="M24.55,79.02 l1.39-3.35"/>
        <path d="M11.02,69.98 l2.56-2.56"/>
        <path d="M1.98,56.45 l3.35-1.39"/>
        <path d="M-1.19,40.5h3.62"/>
        <path d="M1.98,24.55 l3.35,1.39"/>
        <path d="M11.02,11.02 l2.56,2.56"/>
        <path d="M24.55,1.98 l1.39,3.35"/>
      </g>
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        fill="currentColor"
        d="M56.8,55.55c2.24,1.28,5.1,0.52,6.39-1.71 c1.3-2.24,0.54-5.09-1.71-6.38c-0.39-0.23-0.81-0.39-1.23-0.49V34.5c0.43-0.1,0.85-0.27,1.24-0.5c2.24-1.3,3-4.15,1.71-6.39 c-1.3-2.24-4.15-3-6.39-1.71c-0.4,0.23-0.76,0.52-1.06,0.84l-10.78-6.22c0.13-0.42,0.19-0.87,0.19-1.34c0-2.58-2.09-4.67-4.67-4.67 s-4.67,2.09-4.67,4.67c0,0.46,0.07,0.91,0.19,1.33l-10.78,6.22c-0.3-0.32-0.66-0.6-1.06-0.83c-2.24-1.29-5.1-0.52-6.38,1.71 c-1.29,2.24-0.52,5.1,1.71,6.39c0.4,0.23,0.82,0.39,1.25,0.5v12.45c-0.42,0.1-0.84,0.27-1.23,0.49c-2.24,1.3-3,4.15-1.71,6.38 c1.29,2.24,4.14,3,6.39,1.71c0.4-0.23,0.75-0.51,1.05-0.82l10.78,6.22c-0.12,0.42-0.19,0.86-0.19,1.32c0,2.58,2.09,4.67,4.67,4.67 s4.67-2.1,4.67-4.67c0-0.51-0.08-1.01-0.24-1.47l10.71-6.19C55.97,54.97,56.36,55.29,56.8,55.55z M54.6,52.61 c0.03,0.1,0.05,0.21,0.09,0.31l-10.73,6.2c-0.85-0.94-2.08-1.52-3.45-1.52c-1.32,0-2.52,0.55-3.37,1.43l-10.79-6.23 c0.02-0.06,0.03-0.12,0.05-0.18H54.6z M55.91,48.11c-0.32,0.3-0.59,0.65-0.82,1.05c-0.23,0.4-0.39,0.81-0.49,1.23H26.4 c-0.1-0.42-0.27-0.84-0.49-1.23c-0.23-0.39-0.51-0.74-0.82-1.04L39.2,23.68c0.41,0.12,0.85,0.18,1.3,0.18 c0.45,0,0.89-0.06,1.31-0.18L55.91,48.11z M58.02,46.96c-0.06,0.01-0.12,0.03-0.18,0.05L43.73,22.57c0.04-0.04,0.08-0.08,0.13-0.12 l10.8,6.24c-0.33,1.17-0.21,2.47,0.44,3.61c0.66,1.14,1.73,1.9,2.92,2.2V46.96z M37.14,22.44c0.04,0.05,0.09,0.09,0.13,0.13 L23.16,47.01c-0.06-0.02-0.12-0.03-0.18-0.05V34.49c1.19-0.3,2.26-1.05,2.92-2.2c0.66-1.14,0.78-2.45,0.44-3.62L37.14,22.44z"
      />
    </svg>
  );
}

function GraphCDNLogo(props) {
  return (
    <svg
      {...props}
      width="87"
      height="24"
      fill="currentColor"
      viewBox="0 0 87 24"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path d="M33.665 15.413v-3.438h-3.489v1.258h2.097v1.543a3.302 3.302 0 01-1.98.62c-.419 0-.804-.083-1.14-.217a2.748 2.748 0 01-.872-.621 2.667 2.667 0 01-.57-.94 3.32 3.32 0 01-.201-1.173c0-.386.066-.772.2-1.124.135-.352.32-.654.57-.923.236-.268.52-.47.84-.637a2.41 2.41 0 011.04-.218c.268 0 .503.017.72.067.202.034.403.1.588.168.184.084.352.168.52.285.15.1.318.218.47.352l.922-1.09a7.925 7.925 0 00-.655-.47 4.595 4.595 0 00-.704-.352 5.356 5.356 0 00-.822-.201 5.68 5.68 0 00-.973-.084c-.62 0-1.19.117-1.71.335a4.45 4.45 0 00-1.342.923 4.393 4.393 0 00-.872 1.358A4.382 4.382 0 0026 12.462c0 .604.1 1.175.302 1.678.201.52.486.972.855 1.341.37.386.822.671 1.342.89.52.217 1.107.318 1.744.318.35.001.698-.032 1.04-.1.319-.051.62-.152.906-.269.278-.114.547-.248.805-.403.252-.167.47-.318.67-.503zm3.136-1.207c0-.403.05-.772.151-1.074.1-.318.252-.57.436-.771.184-.203.414-.358.671-.453.252-.1.537-.151.855-.151h.084v-1.51c-.553-.016-1.006.118-1.358.403-.37.268-.638.654-.839 1.124v-1.41h-1.425v6.19H36.8v-2.348zm8.302 2.348v-3.657c0-.838-.218-1.475-.67-1.928-.437-.47-1.124-.688-2.047-.688-.503 0-.939.05-1.291.134-.37.1-.721.218-1.057.386l.386 1.124c.267-.11.542-.2.822-.269.285-.084.587-.117.939-.117.503 0 .872.117 1.14.335.252.235.386.57.386.99v.15a8.39 8.39 0 00-.755-.184 5.34 5.34 0 00-.956-.067c-.352 0-.687.034-1.006.118-.302.084-.57.2-.788.369a1.694 1.694 0 00-.52.62c-.134.252-.185.537-.185.89v.016c0 .319.05.587.185.822.117.235.268.436.47.603.2.151.436.269.704.353.252.084.537.134.839.134.47 0 .872-.084 1.19-.268.336-.168.604-.37.805-.62v.754h1.41zm-1.375-2.23c0 .184-.034.368-.117.519a1.208 1.208 0 01-.352.42 1.525 1.525 0 01-.52.268 2.45 2.45 0 01-.638.084c-.335 0-.62-.068-.855-.235a.759.759 0 01-.352-.671v-.034c0-.318.134-.553.385-.738.252-.167.587-.251 1.04-.251.269 0 .537.017.772.067.251.05.47.1.637.184v.386zm9.46-.856c0-.52-.084-.973-.252-1.376a3.071 3.071 0 00-.654-1.006 2.783 2.783 0 00-.906-.637 2.97 2.97 0 00-1.073-.201c-.487 0-.906.1-1.241.335a2.8 2.8 0 00-.84.822v-1.04h-1.425v8.067h1.426l-.017-2.834c.218.285.503.536.839.754.335.218.755.336 1.258.336.369 0 .72-.067 1.073-.218.352-.134.654-.352.923-.62a3.02 3.02 0 00.637-1.024c.168-.385.252-.855.252-1.358zm-1.426 0c0 .302-.05.57-.151.822-.078.234-.21.447-.386.62a1.475 1.475 0 01-.553.403c-.218.1-.436.134-.688.134-.235 0-.47-.034-.688-.134a1.952 1.952 0 01-.57-.403 2.196 2.196 0 01-.402-.62 2.558 2.558 0 01-.135-.822c0-.302.05-.587.135-.822.1-.252.234-.453.402-.62.16-.178.354-.32.57-.42.218-.084.453-.134.688-.134.252 0 .47.05.688.134.218.1.402.235.553.402.168.168.302.386.386.638.1.235.15.52.15.822zm4.294-.403c0-.47.134-.855.385-1.123.252-.269.587-.403 1.007-.403.419 0 .738.134.972.402.218.252.336.621.336 1.107v3.506h1.425v-3.942c0-.72-.184-1.291-.57-1.727-.386-.42-.922-.637-1.627-.637-.235 0-.453.033-.637.083a1.962 1.962 0 00-.537.252c-.15.1-.302.218-.42.335-.116.135-.234.269-.334.42V8H54.63v8.554h1.425v-3.489zm13.132 2.18l-.922-.939a4.415 4.415 0 01-1.074.772c-.352.201-.788.302-1.291.302-.386 0-.738-.084-1.074-.235a2.674 2.674 0 01-.855-.62 2.824 2.824 0 01-.57-.94 3.197 3.197 0 01-.202-1.14c0-.403.067-.789.202-1.14a2.75 2.75 0 01.57-.923c.235-.252.52-.453.855-.62a2.56 2.56 0 011.074-.219c.47 0 .889.084 1.258.285.369.185.72.42 1.04.738l.922-1.073a6.34 6.34 0 00-.62-.52 4.793 4.793 0 00-.705-.403c-.268-.1-.537-.201-.856-.251a4.702 4.702 0 00-1.022-.1c-.621 0-1.191.116-1.711.334a4.05 4.05 0 00-1.325.906c-.386.386-.671.839-.872 1.359a4.162 4.162 0 00-.319 1.643c0 .604.1 1.158.319 1.678.218.503.503.956.872 1.325a3.88 3.88 0 001.325.905c.503.218 1.056.319 1.66.319a5.08 5.08 0 001.04-.1c.319-.051.604-.152.872-.286.269-.134.52-.285.738-.453.235-.184.453-.385.671-.603zm8.923-2.8c0-.57-.1-1.124-.319-1.61a3.931 3.931 0 00-.889-1.309 4.052 4.052 0 00-1.392-.855 4.981 4.981 0 00-1.76-.319h-3.053v8.202h3.052c.638 0 1.224-.1 1.761-.319a4.326 4.326 0 001.392-.855c.386-.37.671-.805.89-1.309a4.08 4.08 0 00.318-1.626zm-1.51.016c0 .42-.067.789-.2 1.124a2.741 2.741 0 01-.588.89 2.319 2.319 0 01-.889.57 3.32 3.32 0 01-1.174.217h-1.627V9.66h1.627c.42 0 .822.067 1.174.202.352.15.654.352.889.604.252.234.436.536.587.888.134.336.201.705.201 1.107zm8.957 1.56L81.18 8.352h-1.325v8.202h1.426v-5.837l4.511 5.837H87V8.352h-1.442v5.67z"/>
      <path
        d="M6.198 10.53l9.819-7.873L12.01.344c-.818-.459-1.739-.459-2.54 0L1.255 5.09a2.345 2.345 0 00-.92.9l-.069.154 2.966 3.52 2.966.867z"
        opacity=".6"
      />
      <path d="M10.45 13.776L2.846 7.977c-1.091-.833-1.45-2.16-1.279-3.078l-.307.188a2.345 2.345 0 00-.92.9l-.034.052c-.017.034-.034.05-.034.085-.188.34-.273.731-.273 1.14v9.47c0 .919.46 1.718 1.261 2.177l2.2 1.258 6.988-6.393z" />
      <path
        d="M16.74 14.116l-12.478 6.53 5.216 3.01c.801.459 1.722.459 2.54 0l4.108-2.381 4.125-2.364c.41-.255.733-.578.955-.986l-.29-.68-2.438-2.789-1.738-.34z"
        opacity=".6"
      />
      <path d="M21.21 17.92l.034-.069c.17-.34.256-.714.256-1.122V8.635c0-.748-.29-1.377-.852-1.887-.085-.068-.188-.153-.273-.204l-7.074 4.608 3.443 2.958 2.182 1.905c.92.782 1.193 2.023.87 3.146l.46-.255c.409-.255.733-.578.954-.987z" />
    </svg>
  );
}



// --------------

ReactDOM.render(<Hello />, document.getElementById("root"));
